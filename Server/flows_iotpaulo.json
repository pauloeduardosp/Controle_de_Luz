[{"id":"21cbdefc.178002","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"a76391e.e9c7d7","type":"tab","label":"Apartamento","disabled":false,"info":""},{"id":"f91e3b4.e8602c8","type":"tab","label":"Status","disabled":false,"info":""},{"id":"b5a5d7d1.da846","type":"tab","label":"teste","disabled":false,"info":""},{"id":"9271b3dc.6bcd3","type":"tab","label":"Previsao","disabled":false,"info":""},{"id":"4633626c.639bcc","type":"subflow","name":"Subflow 1","info":"","in":[{"x":542.5,"y":3128,"wires":[{"id":"776aad44.3dc9b4"}]}],"out":[]},{"id":"25167bbc.e1295c","type":"mqtt-broker","z":"","name":"localhost","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"8dc71b4d.1c3148","type":"mui_link","z":0,"name":"Link 2","icon":"open_in_browser","target":"newtab","order":2},{"id":"1315dab9.1e8fe5","type":"mui_tab","z":0,"name":"Home","icon":"dashboard"},{"id":"c549513f.15f8e","type":"mui_group","z":0,"name":"Default","tab":"1315dab9.1e8fe5","disp":true,"width":"6","collapse":false},{"id":"c8162c71.448a6","type":"mui_base","z":0,"theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"m-base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"m-page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"m-page-backgroundColor":{"value":"#fafafa","edited":false},"m-page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"m-group-textColor":{"value":"#1bbfff","edited":false},"m-group-borderColor":{"value":"#ffffff","edited":false},"m-group-backgroundColor":{"value":"#ffffff","edited":false},"m-widget-textColor":{"value":"#111111","edited":false},"m-widget-backgroundColor":{"value":"#0094ce","edited":false},"m-widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"9e57a1d8.021468","type":"ui_group","z":0,"name":"Quarto","tab":"510e1d1a.eac40c","order":1,"disp":true,"width":"4","collapse":false},{"id":"c1ac0cb6.91c4c8","type":"ui_group","z":0,"name":"NovoDevice","tab":"eb76e7ec.a33d7","disp":true,"width":"6","collapse":false},{"id":"31779852.551a48","type":"ui_group","z":0,"name":"Status","tab":"aa3a149.d5ad168","order":4,"disp":true,"width":"4","collapse":false},{"id":"4c24412b.903b68","type":"ui_group","z":0,"name":"G1","tab":"aa3a149.d5ad168","order":1,"disp":false,"width":"4","collapse":false},{"id":"6825085.446fbf8","type":"ui_group","z":0,"name":"G2","tab":"aa3a149.d5ad168","order":2,"disp":false,"width":"4","collapse":false},{"id":"ac46c281.0280d","type":"ui_group","z":0,"name":"G3","tab":"aa3a149.d5ad168","order":3,"disp":false,"width":"4","collapse":false},{"id":"aabedb75.31173","type":"ui_group","z":0,"name":"Proto","tab":"510e1d1a.eac40c","order":2,"disp":true,"width":"4","collapse":false},{"id":"2d6291f0.c96026","type":"ui_group","z":0,"name":"Varanda","tab":"510e1d1a.eac40c","order":3,"disp":true,"width":"4","collapse":false},{"id":"f4e9319a.8f7d6","type":"ui_group","z":0,"name":"Gauge","tab":"d70fc1da.0bd0b8","disp":false,"width":"8","collapse":false},{"id":"e18c8c18.d7e918","type":"ui_group","z":0,"name":"Default","tab":"3f29b2c6.a2c906","disp":false,"width":"6","collapse":false},{"id":"569e3243.8d0fd4","type":"ui_group","z":"9271b3dc.6bcd3","name":"Default","tab":"b49c345b.32de88","disp":true,"width":"6","collapse":false},{"id":"f1141f30.52cc78","type":"ui_group","z":0,"name":"Externo","tab":"510e1d1a.eac40c","order":4,"disp":true,"width":"4","collapse":false},{"id":"f2318c1f.4bc28","type":"ui_group","z":0,"name":"Group 2","tab":"d70fc1da.0bd0b8","order":2,"disp":true,"width":"8","collapse":false},{"id":"a095bd78.a8514","type":"ui_group","z":0,"name":"Group 1","tab":"79127ce7.39f03c","order":1,"disp":false,"width":"6","collapse":false},{"id":"8e7b88aa.51306","type":"ui_group","z":0,"name":"Teste","tab":"510e1d1a.eac40c","disp":true,"width":"4","collapse":false},{"id":"63d4d9cd.ea7738","type":"ui_group","z":0,"name":"CPU Load","tab":"4bfd1312.595b0c","order":2,"disp":true,"width":"6"},{"id":"60dcfe1.ba26d","type":"ui_group","z":0,"name":"Memory","tab":"4bfd1312.595b0c","order":3,"disp":true,"width":"6"},{"id":"c5221142.3148f","type":"ui_group","z":0,"name":"System Information","tab":"4bfd1312.595b0c","order":1,"disp":true,"width":"6"},{"id":"510e1d1a.eac40c","type":"ui_tab","z":0,"name":"Apartamento","icon":"dashboard","order":1},{"id":"aa3a149.d5ad168","type":"ui_tab","z":0,"name":"Status","icon":"dashboard","order":3},{"id":"eb76e7ec.a33d7","type":"ui_tab","z":0,"name":"NovoDevice","icon":"dashboard","order":4},{"id":"d70fc1da.0bd0b8","type":"ui_tab","z":0,"name":"Gauge","icon":"dashboard","order":6},{"id":"3f29b2c6.a2c906","type":"ui_tab","z":0,"name":"Tab 1","icon":"dashboard","order":5},{"id":"b49c345b.32de88","type":"ui_tab","z":"9271b3dc.6bcd3","name":"tab2","icon":"dashboard","order":7},{"id":"79127ce7.39f03c","type":"ui_tab","z":0,"name":"Celular","icon":"dashboard","order":2},{"id":"4bfd1312.595b0c","type":"ui_tab","z":0,"name":"System","icon":"computer"},{"id":"64754fe7.eacce","type":"ui_base","z":0,"theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"IotPaulo","hideToolbar":"false","allowSwipe":"true","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"3fbd6bac.eb1584","type":"darksky-credentials","z":0,"key_identifier":"darksky"},{"id":"4f0a92c0.2e7b44","type":"debug","z":"21cbdefc.178002","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":406.888916015625,"y":117.22222900390625,"wires":[]},{"id":"b51fff0c.aae1d","type":"debug","z":"21cbdefc.178002","name":"msg1","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":284.5556182861328,"y":277.8887023925781,"wires":[]},{"id":"684e4f16.c4343","type":"function","z":"21cbdefc.178002","name":"Coleta Disconex√£o","func":"//var descTopic = msg.payload;\n\nmsg.topic = msg.payload;\nmsg.payload = \"disconnect\";\n\n\n\nreturn msg\n\n/*\nif(msg.payload === \"room/lamp\")\n{\n    msg.enabled = false;\n\n    \n} else {\n     msg.enabled = true;\n     msg.label = \"teste_label\";\n}\n    return msg;\n    \n    */","outputs":1,"noerr":0,"x":318.72250747680664,"y":321.88852882385254,"wires":[["3c88e480.948924","3cfc2a39.4d83ee"]]},{"id":"3c88e480.948924","type":"mqtt out","z":"21cbdefc.178002","name":"","topic":"","qos":"","retain":"","broker":"25167bbc.e1295c","x":573.7225341796875,"y":279.8885498046875,"wires":[]},{"id":"3cfc2a39.4d83ee","type":"debug","z":"21cbdefc.178002","name":"msg4","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":569.7225341796875,"y":375.8885498046875,"wires":[]},{"id":"5e52ce95.3eba58","type":"mqtt in","z":"a76391e.e9c7d7","name":"ape/quarto/luz","topic":"ape/quarto/luz","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":175.97244262695312,"y":206.44451904296875,"wires":[["28ea3efd.9d0412","7fbfc46f.3dffec","132524ea.ce143b"]]},{"id":"f9699e28.21df48","type":"mqtt out","z":"a76391e.e9c7d7","name":"","topic":"","qos":"","retain":"","broker":"25167bbc.e1295c","x":912.7779541015625,"y":170.25003051757812,"wires":[]},{"id":"30a3e0b9.719d1","type":"change","z":"a76391e.e9c7d7","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"disconnect","fromt":"str","to":"disconnect","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"on","fromt":"str","to":"Ligado","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"off","fromt":"str","to":"Desligado","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":770.9722900390625,"y":339.3055114746094,"wires":[["3d605702.17ad88","8b95da79.3073f8"]]},{"id":"28ea3efd.9d0412","type":"function","z":"a76391e.e9c7d7","name":"Enable/Disable","func":"if(msg.payload === \"disconnect\")\n{\n    msg.enabled = false;\n} else {\n     msg.enabled = true;\n}\nreturn msg;\n\n","outputs":1,"noerr":0,"x":440.69476318359375,"y":147.08343505859375,"wires":[["fc1d6ceb.e75ca","7fbfc46f.3dffec","c2898b7e.605468"]]},{"id":"c8a677e.4327508","type":"mqtt in","z":"a76391e.e9c7d7","name":"ape/quarto","topic":"ape/quarto","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":174.02792358398438,"y":122.08343505859375,"wires":[["28ea3efd.9d0412","ae75103d.f0061","386cacaf.09bb7c"]]},{"id":"7fbfc46f.3dffec","type":"switch","z":"a76391e.e9c7d7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"disconnect","vt":"str"},{"t":"neq","v":"disconnect","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":605.9723815917969,"y":297.638916015625,"wires":[["3d605702.17ad88","8b95da79.3073f8"],["30a3e0b9.719d1"]]},{"id":"a7250b19.263cb","type":"comment","z":"a76391e.e9c7d7","name":"Alterar","info":"","x":184.30563354492188,"y":72.0833740234375,"wires":[]},{"id":"aa35ca26.8fc3f8","type":"json","z":"f91e3b4.e8602c8","name":"","property":"payload","action":"","pretty":false,"x":233.0500030517578,"y":123.64997863769531,"wires":[["69ab3b54.7b777c","190a3bfd.7ff84c","73a7ce58.e1f268"]]},{"id":"16e97787.987ea","type":"switch","z":"f91e3b4.e8602c8","name":"","property":"payload.device","propertyType":"msg","rules":[{"t":"eq","v":"ape/quarto","vt":"str"},{"t":"eq","v":"ape/teste","vt":"str"},{"t":"eq","v":"ape/varanda","vt":"str"},{"t":"nnull"}],"checkall":"false","repair":false,"outputs":4,"x":586.0499877929688,"y":126.09992980957031,"wires":[["c6c618fb.817158","2304faf5.da2cce","db32ffe6.3000a"],["be4d59f3.aeba5","bf0201a0.59ff2"],["1cd8af6c.4d4021","e92f77ae.19ea7"],["a2823727.a9d22"]]},{"id":"82675091.afda68","type":"mqtt in","z":"f91e3b4.e8602c8","name":"","topic":"ape/status","qos":"2","datatype":"auto","broker":"25167bbc.e1295c","x":88.05000305175781,"y":123.24995422363281,"wires":[["aa35ca26.8fc3f8","2498db88.89c654"]]},{"id":"69ab3b54.7b777c","type":"change","z":"f91e3b4.e8602c8","name":"insert timestamp","rules":[{"t":"set","p":"payload.date","pt":"msg","to":"","tot":"date"}],"action":"","property":"","from":"","to":"","reg":false,"x":411.25,"y":127,"wires":[["16e97787.987ea"]]},{"id":"190a3bfd.7ff84c","type":"debug","z":"f91e3b4.e8602c8","name":"Status_json","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":385.9381904602051,"y":46.41731548309326,"wires":[]},{"id":"73a7ce58.e1f268","type":"function","z":"f91e3b4.e8602c8","name":"Send Disconect","func":"if (msg.payload.status === \"red\")\n{\n    msg.topic = msg.payload.device;\n    msg.enabled = false;\n    msg.payload = \"disconnect\"\n    return msg;\n}\n\n","outputs":1,"noerr":0,"x":414.25001525878906,"y":201.00001525878906,"wires":[["881317f0.4d472","97d5153f.c88548"]]},{"id":"881317f0.4d472","type":"debug","z":"f91e3b4.e8602c8","name":"Status_funcao","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":625.0499267578125,"y":298.04998779296875,"wires":[]},{"id":"97d5153f.c88548","type":"mqtt out","z":"f91e3b4.e8602c8","name":"","topic":"","qos":"","retain":"","broker":"25167bbc.e1295c","x":617.25,"y":199.55003356933594,"wires":[]},{"id":"a445f2d9.748558","type":"mqtt in","z":"21cbdefc.178002","name":"","topic":"ape/testamento","qos":"2","datatype":"auto","broker":"25167bbc.e1295c","x":151.5974578857422,"y":488.9542236328125,"wires":[["102baab0.e1937d"]]},{"id":"102baab0.e1937d","type":"debug","z":"21cbdefc.178002","name":"testamento","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":417.450439453125,"y":452.992919921875,"wires":[]},{"id":"f43b0012.92d29","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/varanda/luz","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":267.5777587890625,"y":1047.85546875,"wires":[["cd9caf0b.942bf","31b40c18.dda714","f5e750fa.b8cc9"]]},{"id":"aa42fc6f.a15d98","type":"mqtt out","z":"a76391e.e9c7d7","name":"","topic":"","qos":"","retain":"","broker":"25167bbc.e1295c","x":829.8274955749512,"y":973.328010559082,"wires":[]},{"id":"bee9f782.bd1d38","type":"change","z":"a76391e.e9c7d7","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"on","fromt":"str","to":"Ligado","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"off","fromt":"str","to":"Desligado","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"disconnect","fromt":"str","to":"Disconectado","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":675.2761535644531,"y":1169.1608581542969,"wires":[["7062d76a.426fd","5a59efe3.cc82e"]]},{"id":"cd9caf0b.942bf","type":"function","z":"a76391e.e9c7d7","name":"Enable/Disable","func":"if(msg.payload === \"disconnect\")\n{\n    msg.enabled = false;\n} else {\n     msg.enabled = true;\n}\n\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":475.5222473144531,"y":987.7167358398438,"wires":[["d8a3edb3.7d80d8","31b40c18.dda714","e82d48e7.dce51"]]},{"id":"d5702303.9399f8","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/varanda","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":268.6332244873047,"y":984.4944152832031,"wires":[["cd9caf0b.942bf","ee0b30ee.7e237","6ef8fd66.c1806c"]]},{"id":"4841f3b3.4fa0ec","type":"comment","z":"a76391e.e9c7d7","name":"Alterar group","info":"Alterar group dashboard\n","x":823.1610412597656,"y":1090.8001403808594,"wires":[]},{"id":"46f931e0.be6858","type":"comment","z":"a76391e.e9c7d7","name":"Alterar topic","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":662.6554260253906,"y":955.4722290039062,"wires":[]},{"id":"a6e87f8f.0748d","type":"comment","z":"a76391e.e9c7d7","name":"Alterar topic","info":"locationid/deviceid\nape/teste\n\nlocationid/deviceid/mqttAtuadorId\nape/teste/luz1","x":266.877685546875,"y":949.916748046875,"wires":[]},{"id":"31b40c18.dda714","type":"switch","z":"a76391e.e9c7d7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"disconnect","vt":"str"},{"t":"neq","v":"disconnect","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":532.6610412597656,"y":1113.5220642089844,"wires":[["7062d76a.426fd","5a59efe3.cc82e"],["bee9f782.bd1d38"]]},{"id":"c0f44352.ba7048","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/teste/dht","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":210.85000610351562,"y":1347.8499755859375,"wires":[["88aa44a9.81e5f8"]]},{"id":"88aa44a9.81e5f8","type":"json","z":"a76391e.e9c7d7","name":"","property":"payload","action":"","pretty":false,"x":380.8500061035156,"y":1345.8499755859375,"wires":[["edac3e71.1e2aa8","ed9821e6.806458"]]},{"id":"edac3e71.1e2aa8","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":517.050048828125,"y":1424.6832275390625,"wires":[]},{"id":"ed9821e6.806458","type":"function","z":"a76391e.e9c7d7","name":"","func":"var msgU = { payload: msg.payload.u, topic: 'Umidade'};\nvar msgT = { payload: msg.payload.t, topic: 'Temperatura'};\n\nvar msgU1 = { payload: msg.payload.u, topic: 'Proto'};\nvar msgT1 = { payload: msg.payload.t, topic: 'Proto'};\n\n\nreturn [msgU, msgT, msgU1, msgT1]","outputs":4,"noerr":0,"x":575.8499755859375,"y":1349.8499755859375,"wires":[["c3d9c98a.a033e","d31f8f2.94cdc7"],["308e01da.03cc6e","67ebd135.938f28","d31f8f2.94cdc7"],["71c990fd.a7c34"],["b0d70748.321e28"]]},{"id":"3ca32653.1df1ba","type":"inject","z":"9271b3dc.6bcd3","name":"","topic":"","payload":"","payloadType":"date","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":494.7143249511719,"y":220.2857437133789,"wires":[["53ac6cbb.8a315c"]]},{"id":"53ac6cbb.8a315c","type":"function","z":"9271b3dc.6bcd3","name":"","func":"msg.payload = new Date().toLocaleTimeString();\nreturn msg;","outputs":1,"noerr":0,"x":674.7143249511719,"y":220.2857437133789,"wires":[["3ec90217.280fee"]]},{"id":"94b0d043.674a1","type":"inject","z":"9271b3dc.6bcd3","name":"Force","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":366.33331298828125,"y":783.3333511352539,"wires":[["5b3b28b8.da3a68"]]},{"id":"21b02fb4.42b86","type":"debug","z":"9271b3dc.6bcd3","name":"output","active":true,"tosidebar":true,"console":false,"complete":"true","x":958.3333129882812,"y":711.3333511352539,"wires":[]},{"id":"9d830c5d.8ee3e","type":"function","z":"9271b3dc.6bcd3","name":"timeConvert","func":"if ( !msg.timestamp ) msg.timestamp = Math.round(+new Date());\n\nvar dt = new Date(msg.timestamp);\nvar msg = {\n\t'month':\tdt.getMonth() + 1,\n\t'day':\t\tdt.getDate(),\n\t'year':\t\tdt.getFullYear(),\n\t'hours':\tdt.getHours(),\n\t'mins':\t\tdt.getMinutes(),\n\t'msecs':\tdt.getMilliseconds()\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":762.3333129882812,"y":711.3333511352539,"wires":[["21b02fb4.42b86"]]},{"id":"5b3b28b8.da3a68","type":"function","z":"9271b3dc.6bcd3","name":"set timestamp","func":"msg.timestamp=1376763133 * 1000;\nreturn msg;","outputs":1,"noerr":0,"x":550.3333129882812,"y":783.3333511352539,"wires":[["9d830c5d.8ee3e"]]},{"id":"115eae61.9c9542","type":"inject","z":"9271b3dc.6bcd3","name":"Force","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":366.33331298828125,"y":711.3333511352539,"wires":[["9d830c5d.8ee3e"]]},{"id":"25bc9c5c.160764","type":"inject","z":"9271b3dc.6bcd3","name":"","topic":"","payload":"","payloadType":"date","repeat":"420","crontab":"","once":true,"onceDelay":"","x":328,"y":114.9999771118164,"wires":[["25306ea8.86cf0a"]]},{"id":"25306ea8.86cf0a","type":"http request","z":"9271b3dc.6bcd3","name":"GET ClimaTempo Atual","method":"GET","ret":"obj","paytoqs":false,"url":"http://apiadvisor.climatempo.com.br/api/v1/weather/locale/3477/current?token=6437f1eb0ce7916ac9dcf5338023d66d","tls":"","proxy":"","authType":"","x":548,"y":114.9999771118164,"wires":[["5d0fdef6.4efaf"]]},{"id":"c556c163.76f9f","type":"debug","z":"9271b3dc.6bcd3","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":995,"y":116.99996948242188,"wires":[]},{"id":"5d0fdef6.4efaf","type":"function","z":"9271b3dc.6bcd3","name":"","func":"var now = new Date();\nmsg.payload.update = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});\n\nvar msgU = { payload: msg.payload.data.humidity, topic: \"externo\"};\nvar msgT = { payload: msg.payload.data.temperature, topic: 'externo'};\n\n\nreturn [msg, msgU, msgT]","outputs":3,"noerr":0,"x":744.2000122070312,"y":112.19998931884766,"wires":[["c556c163.76f9f","6f27e993.d78a08","963a7666.2193a"],["14f72a2a.b15da6"],["1a34cb61.70cd45"]]},{"id":"b9356c08.7e2b28","type":"comment","z":"a76391e.e9c7d7","name":"Dash Apartamento","info":"","x":934.7666015625,"y":1382.683349609375,"wires":[]},{"id":"132524ea.ce143b","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":367.20001220703125,"y":277.20001220703125,"wires":[]},{"id":"ae75103d.f0061","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":355.20001220703125,"y":44.19999694824219,"wires":[]},{"id":"f5e750fa.b8cc9","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":451.4999542236328,"y":1169.7999114990234,"wires":[]},{"id":"ee0b30ee.7e237","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":465.1999816894531,"y":946.199951171875,"wires":[]},{"id":"2498db88.89c654","type":"debug","z":"f91e3b4.e8602c8","name":"Status_json","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":245.1999969482422,"y":240.1999969482422,"wires":[]},{"id":"acda5955.9b71a","type":"debug","z":"21cbdefc.178002","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":470.4500045776367,"y":567.2000102996826,"wires":[]},{"id":"be64a4c4.30484","type":"mqtt in","z":"21cbdefc.178002","name":"","topic":"ape/merda","qos":"2","datatype":"auto","broker":"25167bbc.e1295c","x":109.34701538085938,"y":715.4113006591797,"wires":[["e21fea34.9d0368"]]},{"id":"97301480.9f2d","type":"mqtt in","z":"21cbdefc.178002","name":"","topic":"ape/status","qos":"2","datatype":"auto","broker":"25167bbc.e1295c","x":123.19999694824219,"y":642.2000122070312,"wires":[["7308102.327b6f"]]},{"id":"e21fea34.9d0368","type":"json","z":"21cbdefc.178002","name":"","property":"payload","action":"","pretty":false,"x":288.2000045776367,"y":716.6000580787659,"wires":[["8aed7bfd.aad59"]]},{"id":"8aed7bfd.aad59","type":"switch","z":"21cbdefc.178002","name":"","property":"payload.device","propertyType":"msg","rules":[{"t":"eq","v":"ape/quarto","vt":"str"},{"t":"eq","v":"ape/teste","vt":"str"},{"t":"eq","v":"ape/varanda","vt":"str"},{"t":"nnull"}],"checkall":"false","repair":false,"outputs":4,"x":484.949951171875,"y":642.5499877929688,"wires":[[],[],["83ca3f24.9c2528"],[]]},{"id":"83ca3f24.9c2528","type":"debug","z":"21cbdefc.178002","name":"Status_funcao","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":688.6341552734375,"y":643.1090087890625,"wires":[]},{"id":"7308102.327b6f","type":"json","z":"21cbdefc.178002","name":"","property":"payload","action":"","pretty":false,"x":291.00000381469727,"y":635.0000085830688,"wires":[["8aed7bfd.aad59","acda5955.9b71a"]]},{"id":"a9b1853d.93054","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/quarto/dht","qos":"1","broker":"25167bbc.e1295c","x":401.8833312988281,"y":1677.88330078125,"wires":[["8d290780.deb0d"]]},{"id":"8d290780.deb0d","type":"json","z":"a76391e.e9c7d7","name":"","property":"payload","action":"","pretty":false,"x":577.8833312988281,"y":1683.8832397460938,"wires":[["6e27296d.47a4b8","241546a2.b8fea2"]]},{"id":"241546a2.b8fea2","type":"function","z":"a76391e.e9c7d7","name":"","func":"var msgU = { payload: msg.payload.u, topic: \"quarto\"};\nvar msgT = { payload: msg.payload.t, topic: 'quarto' };\n\n\nreturn [msgU, msgT]","outputs":2,"noerr":0,"x":759.88330078125,"y":1690.8832397460938,"wires":[["cf1c4267.3321c","6adc2272.18986c","b3aa79e9.81e41"],["2da905d5.7071da","8ecb88c2.a860c8","33ab044a.aa5b44","982762d.48183a"]]},{"id":"6e27296d.47a4b8","type":"debug","z":"a76391e.e9c7d7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":744.88330078125,"y":1883.88330078125,"wires":[]},{"id":"6adc2272.18986c","type":"link out","z":"a76391e.e9c7d7","name":"ape/quarto Umidade","links":["1ed5005d.402c6"],"x":799.0166625976562,"y":1622.466552734375,"wires":[]},{"id":"8ecb88c2.a860c8","type":"link out","z":"a76391e.e9c7d7","name":"ape/quarto Temperatura","links":["fdeb77d0.025cf8"],"x":802.8833618164062,"y":1758.6332397460938,"wires":[]},{"id":"71c990fd.a7c34","type":"link out","z":"a76391e.e9c7d7","name":"ape/teste Umidade","links":["1ed5005d.402c6"],"x":685,"y":1442,"wires":[]},{"id":"b0d70748.321e28","type":"link out","z":"a76391e.e9c7d7","name":"ape/teste Temperatura","links":["fdeb77d0.025cf8"],"x":646,"y":1476,"wires":[]},{"id":"1ed5005d.402c6","type":"link in","z":"a76391e.e9c7d7","name":"Graf Umidade","links":["6adc2272.18986c","71c990fd.a7c34","14f72a2a.b15da6"],"x":1038.25,"y":1910.25,"wires":[["628928a8.d58338"]]},{"id":"fdeb77d0.025cf8","type":"link in","z":"a76391e.e9c7d7","name":"Graf Temperatura","links":["1a34cb61.70cd45","8ecb88c2.a860c8","b0d70748.321e28"],"x":1048.25,"y":1971.75,"wires":[["f0c4385.a21be48"]]},{"id":"14f72a2a.b15da6","type":"link out","z":"9271b3dc.6bcd3","name":"externo Umidade","links":["1ed5005d.402c6"],"x":943.7500162124634,"y":158.75000286102295,"wires":[]},{"id":"1a34cb61.70cd45","type":"link out","z":"9271b3dc.6bcd3","name":"externo Temperatura","links":["fdeb77d0.025cf8"],"x":937.6167144775391,"y":201.16675090789795,"wires":[]},{"id":"a8f3368d.3449b8","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":634.88330078125,"y":443.4833221435547,"wires":[]},{"id":"921db7ed.32fff","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":915.8832702636719,"y":1162.6833190917969,"wires":[]},{"id":"28b77a88.6c658e","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":1164.63330078125,"y":1687.6834106445312,"wires":[]},{"id":"a32d997.5e89868","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":667.88330078125,"y":34.2833251953125,"wires":[]},{"id":"c860bc31.4d1568","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":1001.88330078125,"y":335.2833251953125,"wires":[]},{"id":"e5c14e88.5b554","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":1121.8831787109375,"y":1325.6834106445312,"wires":[]},{"id":"b3aa79e9.81e41","type":"change","z":"a76391e.e9c7d7","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"'Umidade'","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1019.8208618164062,"y":1609.820556640625,"wires":[["df53ee88.868aa"]]},{"id":"982762d.48183a","type":"change","z":"a76391e.e9c7d7","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"'Temperatura'","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1013.1209106445312,"y":1655.0706176757812,"wires":[["df53ee88.868aa"]]},{"id":"c4cfd31d.4d3488","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/teste/luz","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":247.41110229492188,"y":624.3389129638672,"wires":[["d9483ccc.9902f","81013cc1.6cbb6","71b5dfad.cc9e78"]]},{"id":"55b8d1fa.d7198","type":"mqtt out","z":"a76391e.e9c7d7","name":"","topic":"","qos":"","retain":"","broker":"25167bbc.e1295c","x":807.6607666015625,"y":572.8112182617188,"wires":[]},{"id":"34a43d9e.bf17b2","type":"change","z":"a76391e.e9c7d7","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"on","fromt":"str","to":"Ligado","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"off","fromt":"str","to":"Desligado","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":"disconnect","fromt":"str","to":"Disconectado","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.1094970703125,"y":748.644287109375,"wires":[["b77d1915.afe938","743fed93.2e56cc"]]},{"id":"d9483ccc.9902f","type":"function","z":"a76391e.e9c7d7","name":"Enable/Disable","func":"if(msg.payload === \"disconnect\")\n{\n    msg.enabled = false;\n} else {\n     msg.enabled = true;\n}\n\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":466.3555908203125,"y":570.2001342773438,"wires":[["b62a2579.b3a798","81013cc1.6cbb6","519af793.6248c"]]},{"id":"54130ac9.545fac","type":"mqtt in","z":"a76391e.e9c7d7","name":"","topic":"ape/teste","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":249.46656799316406,"y":566.9778137207031,"wires":[["d9483ccc.9902f"]]},{"id":"d356339a.10e71","type":"comment","z":"a76391e.e9c7d7","name":"Alterar group","info":"Alterar group dashboard\n","x":756.994384765625,"y":645.2835693359375,"wires":[]},{"id":"e35080b1.5860d8","type":"comment","z":"a76391e.e9c7d7","name":"Alterar topic","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":653.48876953125,"y":537.9556274414062,"wires":[]},{"id":"cad6ca89.d6133","type":"comment","z":"a76391e.e9c7d7","name":"Alterar topic","info":"locationid/deviceid\nape/teste\n\nlocationid/deviceid/mqttAtuadorId\nape/teste/luz1","x":241.7354278564453,"y":505.79364013671875,"wires":[]},{"id":"81013cc1.6cbb6","type":"switch","z":"a76391e.e9c7d7","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"disconnect","vt":"str"},{"t":"neq","v":"disconnect","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":523.494384765625,"y":696.0054626464844,"wires":[["b77d1915.afe938","743fed93.2e56cc"],["34a43d9e.bf17b2"]]},{"id":"71b5dfad.cc9e78","type":"debug","z":"a76391e.e9c7d7","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":442.0666809082031,"y":754.5778503417969,"wires":[]},{"id":"8a9f9a4e.f772d","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":857.88330078125,"y":716.6832885742188,"wires":[]},{"id":"39a1ed51.1a53b2","type":"comment","z":"a76391e.e9c7d7","name":"View Celular","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":658.8832702636719,"y":886.0833435058594,"wires":[]},{"id":"5650bfb2.1d3288","type":"comment","z":"a76391e.e9c7d7","name":"Alterar topic","info":"locationid/deviceid/mqttAtuadorId/change\n\nape/teste/luz1/change","x":691.88330078125,"y":127.88333129882812,"wires":[]},{"id":"12ff0461.de9d4c","type":"comment","z":"a76391e.e9c7d7","name":"Dash Gauge","info":"","x":782.88330078125,"y":1254.2833251953125,"wires":[]},{"id":"226413ae.9c2f6c","type":"http request","z":"b5a5d7d1.da846","name":"Post to Pushover","method":"POST","ret":"txt","url":"https://api.pushover.net/1/messages.json","tls":"","x":595.88330078125,"y":89.88334655761719,"wires":[[]]},{"id":"1b58c71.2b18ab9","type":"function","z":"b5a5d7d1.da846","name":"","func":"msg.headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n};\nmsg.payload = { \n    user: 'USERKEYHERE',\n    token: 'ApplicationKeyHere',\n    message: 'MESSAGE HERE',\n    title: 'TITLE HERE',\n    priority: '-1'\n};\nreturn msg;","outputs":1,"noerr":0,"x":401.88323974609375,"y":89.54998779296875,"wires":[["226413ae.9c2f6c"]]},{"id":"99148640.dd6878","type":"http request","z":"b5a5d7d1.da846","name":"Post to Pushover","method":"POST","ret":"txt","url":"https://api.pushover.net/1/messages.json","tls":"","x":587.88330078125,"y":163.8833465576172,"wires":[[]]},{"id":"93b41206.817138","type":"function","z":"b5a5d7d1.da846","name":"","func":"msg.headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\"\n};\nmsg.payload = { \n    user: 'USERKEYHERE',\n    token: 'ApplicationKeyHere',\n    message: 'MESSAGE HERE',\n    title: 'TITLE HERE',\n    priority: '-1'\n};\nreturn msg;","outputs":1,"noerr":0,"x":393.88323974609375,"y":163.54998779296875,"wires":[["99148640.dd6878"]]},{"id":"b33427bb.996048","type":"inject","z":"b5a5d7d1.da846","name":"","topic":"","payload":"teste pushover","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":234.76666259765625,"y":375.5666961669922,"wires":[["8e9e9501.a071e"]]},{"id":"2304faf5.da2cce","type":"debug","z":"f91e3b4.e8602c8","name":"Status_funcao","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":809.88330078125,"y":23.883331298828125,"wires":[]},{"id":"533463c.66cef1c","type":"split","z":"f91e3b4.e8602c8","name":"","splt":"d ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"payload.teste","x":904.7666015625,"y":420.933349609375,"wires":[["65abca4a.f04b54","a3e6f9a1.baca2"]]},{"id":"db32ffe6.3000a","type":"function","z":"f91e3b4.e8602c8","name":"Enable/Disable","func":"msg.payload = msg.payload.up\n\nflow.set(\"uptimeQ\", msg.payload);\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":735.88330078125,"y":390.8833312988281,"wires":[["533463c.66cef1c"]]},{"id":"65abca4a.f04b54","type":"function","z":"f91e3b4.e8602c8","name":"","func":"if(msg.parts.index===0) \n{\n    if(msg.payload >= flow.get(\"lasduptimedayQ\"))\n    {\n        flow.set(\"lasduptimedayQ\", msg.payload)\n        flow.set(\"maxuptimeQ\", flow.get(\"uptimeQ\"));\n    } \n    flow.set(\"lasduptimedayQ\", msg.payload)\n\n}\n\nvar msg1 =  { payload: flow.get(\"maxuptimeQ\")};\n\nreturn [msg1, null]\n","outputs":2,"noerr":0,"x":1034.8828125,"y":419.97265625,"wires":[["13bef1cc.2a71c6","f8fa5d78.db2278"],[]]},{"id":"e92f77ae.19ea7","type":"function","z":"f91e3b4.e8602c8","name":"Enable/Disable","func":"msg.payload = msg.payload.up\n\nflow.set(\"uptimeV\", msg.payload);\n\nreturn msg;\n","outputs":1,"noerr":0,"x":720.4000244140625,"y":486.20001220703125,"wires":[["c9c00f82.438d08"]]},{"id":"c9c00f82.438d08","type":"split","z":"f91e3b4.e8602c8","name":"","splt":"d ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"payload.teste","x":909.2833251953125,"y":492.2500305175781,"wires":[["1c1404fe.317753","2f180595.d89c72"]]},{"id":"bf0201a0.59ff2","type":"function","z":"f91e3b4.e8602c8","name":"Enable/Disable teste","func":"msg.payload = msg.payload.up\n\nflow.set(\"uptime\", msg.payload);\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":703.4000854492188,"y":624.2000732421875,"wires":[["cdceb8a5.99c7d"]]},{"id":"cdceb8a5.99c7d","type":"split","z":"f91e3b4.e8602c8","name":"","splt":"d ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"payload.teste","x":918.2833251953125,"y":640.25,"wires":[["1ff9d802.fd0ba"]]},{"id":"1ff9d802.fd0ba","type":"function","z":"f91e3b4.e8602c8","name":"","func":"if(msg.parts.index===0) \n{\n    if(msg.payload >= flow.get(\"lasduptimeday\"))\n    {\n        flow.set(\"maxuptime\", flow.get(\"uptime\"));\n        flow.set(\"lasduptimeday\", msg.payload)\n        var msg2 = {payload: \"if ok\"};\n    } \n    \n\n}\n\nvar msg1 =  { payload: flow.get(\"maxuptime\")};\n\n\nreturn [msg1, msg2]","outputs":2,"noerr":0,"x":1079.3994750976562,"y":626.289306640625,"wires":[["c18efbaa.7c50a8"],["3a7b043a.bae5b4"]]},{"id":"49406886.632248","type":"inject","z":"f91e3b4.e8602c8","name":"quarto","topic":"","payload":"q","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":902.5,"y":261,"wires":[["fc97b0f1.c47bc8"]]},{"id":"f8fa5d78.db2278","type":"debug","z":"f91e3b4.e8602c8","name":"if 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1263.4999389648438,"y":641.7999877929688,"wires":[]},{"id":"fc97b0f1.c47bc8","type":"function","z":"f91e3b4.e8602c8","name":"","func":"if (msg.payload ===\"q\")\n{\n\n    flow.set(\"maxuptimeQ\", '0d0');\n    flow.set(\"lasduptimedayQ\", 1)\n    var msg1 = {payload : \"0\"};  \n    return [msg1, null, null]\n\n} \nelse if (msg.payload === \"v\")\n{\n    flow.set(\"maxuptimeV\", '5d00:00');\n    flow.set(\"lasduptimedayV\", 5)\n    var msg1 = {payload : \"0\"};  \n    return [null, msg1, null]\n}\n\nelse if (msg.payload === \"p\")\n{\n    flow.set(\"maxuptime\", '0d0');\n    flow.set(\"lasduptimeday\", 1)\n    var msg1 = {payload : \"0\"};  \n    \n    return [null, null, msg1]\n}","outputs":3,"noerr":0,"x":1057.4000244140625,"y":296.20001220703125,"wires":[["533463c.66cef1c"],["c9c00f82.438d08"],["cdceb8a5.99c7d","4e114ab5.5e9804"]]},{"id":"29b3f681.1e529a","type":"inject","z":"f91e3b4.e8602c8","name":"varanda","topic":"","payload":"v","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":895.7999877929688,"y":294.20001220703125,"wires":[["fc97b0f1.c47bc8"]]},{"id":"e09131c1.f7d8d","type":"inject","z":"f91e3b4.e8602c8","name":"protoboard","topic":"","payload":"p","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":898.7999877929688,"y":331.20001220703125,"wires":[["fc97b0f1.c47bc8"]]},{"id":"4e114ab5.5e9804","type":"debug","z":"f91e3b4.e8602c8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1260.800048828125,"y":308.20001220703125,"wires":[]},{"id":"a3e6f9a1.baca2","type":"debug","z":"f91e3b4.e8602c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1062.9999389648438,"y":689.2000122070312,"wires":[]},{"id":"3a7b043a.bae5b4","type":"debug","z":"f91e3b4.e8602c8","name":"if 2","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1262.5999145507812,"y":680.2000122070312,"wires":[]},{"id":"9ece1ae5.5173b","type":"debug","z":"f91e3b4.e8602c8","name":"V if 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1246.1998901367188,"y":531.2000122070312,"wires":[]},{"id":"1c1404fe.317753","type":"debug","z":"f91e3b4.e8602c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1070.199951171875,"y":550.2000122070312,"wires":[]},{"id":"2f180595.d89c72","type":"function","z":"f91e3b4.e8602c8","name":"","func":"if(msg.parts.index===0) \n{\n    if(msg.payload >= flow.get(\"lasduptimedayQ\"))\n    {\n        flow.set(\"lasduptimedayV\", msg.payload)\n        flow.set(\"maxuptimeV\", flow.get(\"uptimeV\"));\n    } \n    flow.set(\"lasduptimedayV\", msg.payload)\n\n}\n\nvar msg1 =  { payload: flow.get(\"maxuptimeV\")};\n\nreturn [msg1, null]\n","outputs":2,"noerr":0,"x":1048.199951171875,"y":484.20001220703125,"wires":[["3b4ffdc9.37fa2a","9ece1ae5.5173b"],[]]},{"id":"776aad44.3dc9b4","type":"mui_text","z":"21cbdefc.178002","group":"c549513f.15f8e","order":0,"width":0,"height":0,"name":"","label":"text","format":"{{msg.payload}}","layout":"row-spread","x":672.5,"y":3128,"wires":[]},{"id":"fc1d6ceb.e75ca","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"9e57a1d8.021468","order":1,"width":"2","height":"1","passthru":false,"label":"Luz","tooltip":"","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/quarto/luz/change","x":689.222412109375,"y":168.7222900390625,"wires":[["f9699e28.21df48"]]},{"id":"d8a3edb3.7d80d8","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"2d6291f0.c96026","order":1,"width":"2","height":"1","passthru":false,"label":"Luz","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/varanda/luz/change","x":657.0499572753906,"y":989.7999267578125,"wires":[["aa42fc6f.a15d98"]]},{"id":"e82d48e7.dce51","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"a095bd78.a8514","order":9,"width":"2","height":"1","passthru":false,"label":"Varanda","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/varanda/luz/change","x":675.8832702636719,"y":922.0833129882812,"wires":[["aa42fc6f.a15d98"]]},{"id":"c2898b7e.605468","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"a095bd78.a8514","order":1,"width":"2","height":"1","passthru":false,"label":"Quarto","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/quarto/luz/change","x":677.88330078125,"y":66.88333129882812,"wires":[["f9699e28.21df48"]]},{"id":"b62a2579.b3a798","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"aabedb75.31173","order":1,"width":"2","height":"1","passthru":false,"label":"Luz","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/teste/luz/change","x":647.88330078125,"y":572.2833251953125,"wires":[["55b8d1fa.d7198"]]},{"id":"519af793.6248c","type":"ui_button","z":"a76391e.e9c7d7","name":"","group":"a095bd78.a8514","order":5,"width":"2","height":"1","passthru":false,"label":"Proto","color":"","bgcolor":"","icon":"wb_incandescent","payload":"change","payloadType":"str","topic":"ape/teste/luz/change","x":644.88330078125,"y":478.28330993652344,"wires":[["55b8d1fa.d7198"]]},{"id":"3d605702.17ad88","type":"ui_text","z":"a76391e.e9c7d7","group":"9e57a1d8.021468","order":2,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":949.7223510742188,"y":293.3333435058594,"wires":[]},{"id":"7062d76a.426fd","type":"ui_text","z":"a76391e.e9c7d7","group":"2d6291f0.c96026","order":2,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":824.8833312988281,"y":1123.0773620605469,"wires":[]},{"id":"3ec90217.280fee","type":"ui_text","z":"9271b3dc.6bcd3","group":"569e3243.8d0fd4","order":1,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload}}","layout":"row-spread","x":814.7143249511719,"y":220.2857437133789,"wires":[]},{"id":"308e01da.03cc6e","type":"ui_text","z":"a76391e.e9c7d7","group":"aabedb75.31173","order":3,"width":"2","height":"1","name":"","label":"Temperatura","format":"{{msg.payload | number:1}} ¬∞C ","layout":"col-center","x":938.333251953125,"y":1454.111083984375,"wires":[]},{"id":"c3d9c98a.a033e","type":"ui_text","z":"a76391e.e9c7d7","group":"aabedb75.31173","order":4,"width":"2","height":"1","name":"","label":"Umidade","format":"{{msg.payload | number:1}} %","layout":"col-center","x":937.5999755859375,"y":1419.599853515625,"wires":[]},{"id":"cf1c4267.3321c","type":"ui_text","z":"a76391e.e9c7d7","group":"9e57a1d8.021468","order":4,"width":"2","height":"1","name":"","label":"Umidade","format":"{{msg.payload | number:1}} %","layout":"col-center","x":954.8833618164062,"y":1738.1333618164062,"wires":[]},{"id":"2da905d5.7071da","type":"ui_text","z":"a76391e.e9c7d7","group":"9e57a1d8.021468","order":3,"width":"2","height":"1","name":"","label":"Temperatura","format":"{{msg.payload | number:1}} ¬∞C ","layout":"col-center","x":958.1166381835938,"y":1776.3944702148438,"wires":[]},{"id":"5a59efe3.cc82e","type":"ui_text","z":"a76391e.e9c7d7","group":"a095bd78.a8514","order":10,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":916.8832702636719,"y":1196.0833129882812,"wires":[]},{"id":"33ab044a.aa5b44","type":"ui_text","z":"a76391e.e9c7d7","group":"a095bd78.a8514","order":3,"width":"2","height":"1","name":"","label":"Temperatura","format":"{{msg.payload | number:1}} ¬∞C ","layout":"col-center","x":1168.133056640625,"y":1723.2334594726562,"wires":[]},{"id":"8b95da79.3073f8","type":"ui_text","z":"a76391e.e9c7d7","group":"a095bd78.a8514","order":2,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":983.88330078125,"y":370.88336181640625,"wires":[]},{"id":"67ebd135.938f28","type":"ui_text","z":"a76391e.e9c7d7","group":"a095bd78.a8514","order":7,"width":"2","height":"1","name":"","label":"Temperatura","format":"{{msg.payload | number:1}} ¬∞C ","layout":"col-center","x":1122.63330078125,"y":1359.4832763671875,"wires":[]},{"id":"b77d1915.afe938","type":"ui_text","z":"a76391e.e9c7d7","group":"aabedb75.31173","order":2,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":774.7166748046875,"y":680.560791015625,"wires":[]},{"id":"743fed93.2e56cc","type":"ui_text","z":"a76391e.e9c7d7","group":"a095bd78.a8514","order":6,"width":"2","height":"1","name":"","label":"","format":"{{msg.payload}}","layout":"row-center","x":861.88330078125,"y":747.2833251953125,"wires":[]},{"id":"be4d59f3.aeba5","type":"ui_template","z":"f91e3b4.e8602c8","group":"6825085.446fbf8","name":"ape/teste","order":1,"width":"4","height":"4","format":"<svg width=\"180\" height=\"35\">\n    \n    <circle id=\"circle1\" cx=\"20\" cy=\"20\" r=\"10\"\n            style=\"stroke: none; fill: {{msg.payload.status}}\"/>\n    <text font-size=\"18px\" font-weight=\"bold\" \n            x=\"48\" y=\"25\"  fill=\"white\">{{msg.payload.device}}</text>\n</svg>\n\n\n<table width=180px>\n\n  <tr>\n    <td>IP</td>\n    <td align=\"right\"><B>{{msg.payload.ip}}</B></td>\n  </tr>\n  <tr>\n    <td>UpTime</td>\n    <td align=\"right\"><B>{{msg.payload.up}}</B></td>\n  </tr>\n  <tr>\n    <td>Reset</td>\n    <td align=\"right\"><B>{{msg.payload.reset}}</B></td>\n  </tr>\n  <tr>\n    <td>Versao</td>\n    <td align=\"right\"><B>{{msg.payload.ver}}</B></td>\n  </tr>\n  <tr>\n    <td>UpDate</td>\n    <td align=\"right\"><B>{{msg.payload.date | date:'dd/MM - HH:mm'}}</B></td>\n  </tr>\n</table>\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":802.0499877929688,"y":110.09992980957031,"wires":[[]]},{"id":"c6c618fb.817158","type":"ui_template","z":"f91e3b4.e8602c8","group":"4c24412b.903b68","name":"ape/quarto 22","order":1,"width":"4","height":"4","format":"<svg width=\"180\" height=\"35\">\n    \n    <circle id=\"circle1\" cx=\"20\" cy=\"20\" r=\"10\"\n            style=\"stroke: none; fill: {{msg.payload.status}}\"/>\n    <text font-size=\"18px\" font-weight=\"bold\" \n            x=\"48\" y=\"25\"  fill=\"white\">{{msg.payload.device}}</text>\n</svg>\n<table width=180px>\n\n  <tr>\n    <td>IP</td>\n    <td align=\"right\"><B>{{msg.payload.ip}}</B></td>\n  </tr>\n  <tr>\n    <td>UpTime</td>\n    <td align=\"right\"><B>{{msg.payload.up}}</B></td>\n  </tr>\n  <tr>\n    <td>Reset</td>\n    <td align=\"right\"><B>{{msg.payload.reset}}</B></td>\n  </tr>\n    <tr>\n    <td>Versao</td>\n    <td align=\"right\"><B>{{msg.payload.ver}}</B></td>\n  </tr>\n  <tr>\n    <td>UpDate</td>\n    <td align=\"right\"><B>{{msg.payload.date | date:'dd/MM - HH:mm'}}</B></td>\n  </tr>\n</table>\n22\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":821.4334716796875,"y":67.26106262207031,"wires":[[]]},{"id":"1cd8af6c.4d4021","type":"ui_template","z":"f91e3b4.e8602c8","group":"ac46c281.0280d","name":"Ape/Varanda 15","order":1,"width":"4","height":"4","format":"<svg width=\"180\" height=\"35\">\n    \n    <circle id=\"circle1\" cx=\"20\" cy=\"20\" r=\"10\"\n            style=\"stroke: none; fill: {{msg.payload.status}}\"/>\n    <text font-size=\"18px\" font-weight=\"bold\" \n            x=\"48\" y=\"25\"  fill=\"white\">{{msg.payload.device}}</text>\n</svg>\n<table width=180px>\n\n  <tr>\n    <td>IP</td>\n     <td align=\"right\"><B>{{msg.payload.ip}}</B></td>\n  </tr>\n  <tr>\n    <td>UpTime</td>\n    <td align=\"right\"><B>{{msg.payload.up}}</B></td>\n  </tr>\n  <tr>\n    <td>Reset</td>\n    <td align=\"right\"><B>{{msg.payload.reset}}</B></td>\n  </tr>\n    <tr>\n    <td>Versao</td>\n    <td align=\"right\"><B>{{msg.payload.ver}}</B></td>\n  </tr>\n  <tr>\n    <td>UpDate</td>\n    <td align=\"right\"><B>{{msg.payload.date | date:'dd/MM - HH:mm'}}</B></td>\n  </tr>\n</table>\n15\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":846.8333740234375,"y":140.61111450195312,"wires":[[]]},{"id":"a2823727.a9d22","type":"ui_template","z":"f91e3b4.e8602c8","group":"ac46c281.0280d","name":"","order":3,"width":"4","height":"4","format":"<svg width=\"180\" height=\"35\">\n    \n    <circle id=\"circle1\" cx=\"20\" cy=\"20\" r=\"10\"\n            style=\"stroke: none; fill: {{msg.payload.status}}\"/>\n    <text font-size=\"18px\" font-weight=\"bold\" \n            x=\"48\" y=\"25\"  fill=\"white\">{{msg.payload.device}}</text>\n</svg>\n<table width=180px>\n\n  <tr>\n    <td>IP</td>\n     <td align=\"right\"><B>{{msg.payload.ip}}</B></td>\n  </tr>\n  <tr>\n    <td>UpTime</td>\n    <td align=\"right\"><B>{{msg.payload.up}}</B></td>\n  </tr>\n  <tr>\n    <td>Reset</td>\n    <td align=\"right\"><B>{{msg.payload.reset}}</B></td>\n  </tr>\n    <tr>\n    <td>Versao</td>\n    <td align=\"right\"><B>{{msg.payload.ver}}</B></td>\n  </tr>\n  <tr>\n    <td>UpDate</td>\n    <td align=\"right\"><B>{{msg.payload.date | date:'dd/MM - HH:mm'}}</B></td>\n  </tr>\n</table>\n\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":803.0499877929688,"y":185.0500030517578,"wires":[[]]},{"id":"6f27e993.d78a08","type":"ui_template","z":"9271b3dc.6bcd3","group":"f1141f30.52cc78","name":"HTML Temperatura","order":2,"width":"4","height":"3","format":"<table border=0 cellspacing=\"1\">\n    <tr>\n        <td align='center' COLSPAN=\"3\">\n           <font size=\"3\">{{msg.payload.name}} - {{msg.payload.state}}</font>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img style=\"display: block; margin-left: auto; margin-right: auto;\" src=/{{msg.payload.data.icon}}.png width=\"55\" height=\"55\">\n        </td>\n        <th>\n            <font size=\"7\">{{msg.payload.data.temperature}}¬∞</font>\n            <font size=\"3\">{{msg.payload.data.humidity}}%</font>    \n        </th>\n        <!---\n        <th align='bottom'>\n            <font size=\"3\">{{msg.payload.data.humidity}}%</font>\n        </th>  -->\n    </tr>\n    <tr>\n        <td  align='center' COLSPAN=\"3\">\n            <font size=\"3\">{{msg.payload.data.condition}}</font>\n        </td>\n    </tr>\n    <tr>\n        <td align='center' COLSPAN=\"3\">\n            <font size=\"2\">Update {{msg.payload.update}}</font>\n        </td>\n    </tr>\n</table>\n\n","storeOutMessages":false,"fwdInMessages":true,"templateScope":"local","x":907,"y":61,"wires":[[]]},{"id":"963a7666.2193a","type":"ui_template","z":"9271b3dc.6bcd3","group":"a095bd78.a8514","name":"HTML Temperatura","order":11,"width":"6","height":"3","format":"<center>\n<table border=0 cellspacing=\"1\">\n    <tr>\n        <td align='center' COLSPAN=\"3\">\n           <font size=\"3\">{{msg.payload.name}} - {{msg.payload.state}}</font>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img style=\"display: block; margin-left: auto; margin-right: auto;\" src=/{{msg.payload.data.icon}}.png width=\"55\" height=\"55\">\n        </td>\n        <th>\n            <font size=\"7\">{{msg.payload.data.temperature}}¬∞</font>\n            <font size=\"3\">{{msg.payload.data.humidity}}%</font>    \n        </th>\n        <!---\n        <th align='bottom'>\n            <font size=\"3\">{{msg.payload.data.humidity}}%</font>\n        </th>  -->\n    </tr>\n    <tr>\n        <td  align='center' COLSPAN=\"3\">\n            <font size=\"3\">{{msg.payload.data.condition}}</font>\n        </td>\n    </tr>\n    <tr>\n        <td align='center' COLSPAN=\"3\">\n            <font size=\"2\">Update {{msg.payload.update}}</font>\n        </td>\n    </tr>\n</table>\n</center>\n","storeOutMessages":false,"fwdInMessages":true,"templateScope":"local","x":1149.8541259765625,"y":63.604164123535156,"wires":[[]]},{"id":"3b4ffdc9.37fa2a","type":"ui_template","z":"f91e3b4.e8602c8","group":"ac46c281.0280d","name":"uptimevaranda","order":2,"width":"4","height":"1","format":"{{msg.payload}}","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1192.5167236328125,"y":482.5166931152344,"wires":[[]]},{"id":"c18efbaa.7c50a8","type":"ui_template","z":"f91e3b4.e8602c8","group":"6825085.446fbf8","name":"uptimeteste","order":2,"width":"4","height":"1","format":"{{msg.payload}}","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1298.5166625976562,"y":595.5167236328125,"wires":[[]]},{"id":"13bef1cc.2a71c6","type":"ui_template","z":"f91e3b4.e8602c8","group":"4c24412b.903b68","name":"uptimequarto","order":2,"width":"4","height":"1","format":"{{msg.payload}}","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1198.4000244140625,"y":422.20001220703125,"wires":[[]]},{"id":"d31f8f2.94cdc7","type":"ui_chart","z":"a76391e.e9c7d7","name":"","group":"f2318c1f.4bc28","order":3,"width":0,"height":0,"label":"Proto","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#ff8000","#d62727","#1f77b4","#d62727","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":801.6331787109375,"y":1289.88330078125,"wires":[[],[]]},{"id":"df53ee88.868aa","type":"ui_chart","z":"a76391e.e9c7d7","name":"","group":"f2318c1f.4bc28","order":3,"width":0,"height":0,"label":"Quarto","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#d62727","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1235.6041259765625,"y":1620.354248046875,"wires":[[]]},{"id":"628928a8.d58338","type":"ui_chart","z":"a76391e.e9c7d7","name":"","group":"f2318c1f.4bc28","order":2,"width":0,"height":0,"label":"TUmid 1D","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"1","removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#d62727","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":1189.88330078125,"y":1911.88330078125,"wires":[[],[]]},{"id":"f0c4385.a21be48","type":"ui_chart","z":"a76391e.e9c7d7","name":"","group":"f2318c1f.4bc28","order":1,"width":"0","height":"0","label":"TTemp 1D","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"1","removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#d62727","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":1185.88330078125,"y":1974.88330078125,"wires":[[],[]]},{"id":"8e9e9501.a071e","type":"pushover","z":"b5a5d7d1.da846","name":"nome","device":"","title":"teste","priority":0,"sound":"","url":"url","url_title":"url title","html":false,"x":467.2666320800781,"y":374.30006408691406,"wires":[]},{"id":"6ef8fd66.c1806c","type":"pushover","z":"a76391e.e9c7d7","name":"","device":"","title":"Varanda","priority":0,"sound":"","url":"","url_title":"","html":false,"x":459.2666015625,"y":887.2999572753906,"wires":[]},{"id":"386cacaf.09bb7c","type":"pushover","z":"a76391e.e9c7d7","name":"","device":"","title":"Quarto","priority":0,"sound":"","url":"","url_title":"","html":false,"x":366,"y":95,"wires":[]},{"id":"bc9d2a19.b1f9a","type":"mosca in","z":"21cbdefc.178002","mqtt_port":"1883","mqtt_ws_port":8080,"name":"","username":"","password":"","dburl":"","x":178.88888549804688,"y":117.22222900390625,"wires":[["4f0a92c0.2e7b44"]]},{"id":"a574d234.95ef28","type":"mqtt in","z":"21cbdefc.178002","name":"disconect","topic":"$SYS/+/disconnect/clients","qos":"1","datatype":"auto","broker":"25167bbc.e1295c","x":103.5439224243164,"y":318.09649658203125,"wires":[["b51fff0c.aae1d"]]}]